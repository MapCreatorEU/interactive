var M4nInteractive=function(a,b,c){"use strict";function d(a){if(h(),m.object=g(a),m.object.levels.count()>1&&i(),!b.hasPredefinedHeight){var d=m.object.levels.getCurrent();m.object.canvas.height=b.clientWidth*(d.size.height/d.size.width)}for(var f in n)n.hasOwnProperty(f)&&n[f].checkIfNeeded();e(),m.object.popups.generateHTML(),m.api.reset(),"function"==typeof c&&c(A),m.endTime=(new Date).getTime(),m.dev&&console.info("It took "+(m.endTime-m.startTime)+"ms to start up")}function e(){m.object.canvas.addEventListener("mousedown",y.mouseDown),m.object.canvas.addEventListener("touchstart",y.touchStart),document.addEventListener("mouseup",y.mouseUp),document.addEventListener("touchend",y.touchEnd),document.addEventListener("mousemove",y.mouseMove),document.addEventListener("touchmove",y.touchMove),m.object.canvas.addEventListener("mousewheel",y.mouseWheel),m.object.canvas.addEventListener("DOMMouseScroll",y.mouseWheel),m.object.canvas.addEventListener("contextmenu",y.contextMenu),window.addEventListener("resize",y.resize),window.addEventListener("orientationchange",y.resize)}function f(a){var b=document.createElementNS("http://www.w3.org/2000/svg","svg"),c=b.createSVGMatrix();a.getTransform=function(){return c};var d=[],e=a.save;a.save=function(){return d.push(c.translate(0,0)),e.call(a)};var f=a.restore;a.restore=function(){return c=d.pop(),f.call(a)};var g=a.scale;a.scale=function(b,d){return c=c.scaleNonUniform(b,d),g.call(a,b,d)};var h=a.rotate;a.rotate=function(b){return c=c.rotate(180*b/Math.PI),h.call(a,b)};var i=a.translate;a.translate=function(b,d){return c=c.translate(b,d),i.call(a,b,d)};var j=a.transform;a.transform=function(d,e,f,g,h,i){var k=b.createSVGMatrix();return k.a=d,k.b=e,k.c=f,k.d=g,k.e=h,k.f=i,c=c.multiply(k),j.call(a,d,e,f,g,h,i)};var k=a.setTransform;a.setTransform=function(b,d,e,f,g,h){return c.a=b,c.b=d,c.c=e,c.d=f,c.e=g,c.f=h,k.call(a,b,d,e,f,g,h)};var l=b.createSVGPoint();a.transformedPoint=function(a,b){return l.x=a,l.y=b,l.matrixTransform(c.inverse())}}function g(a){var b={levels:r,level:q,tiles:x,tile:w,points:t,point:s,popup:u,popups:v},c=JSON.parse(a,function(a,c){if(null!==c){if(""===a)return new p(c);if(null!==c)return c._type?b[c._type]?new b[c._type](c):(console.error("Unknown class type in save: "+c._type),null):c}});return c.levels.list.forEach(function(a){a.tiles.list.forEach(function(b){b.level=a.level})}),c}function h(){m.isIframe&&(document.body.style.margin="0");var c=document.createElement("link");c.id="m4n-style",c.rel="stylesheet",c.type="text/css",c.href=function(){switch(a.environment){case"development":return location.href.split("/").slice(0,-1).join("/")+"/style.css";case"local":return a.path+"style.css";default:return"//"+a.environment+".maps4news.com/ia/"+m.version.map+"/style.css"}}(),document.head.appendChild(c);var d=document.getElementById("m4n-style-custom");if(null!==d){var e=document.createElement("link");e.id="m4n-style-custom",e.rel="stylesheet",e.type="text/css",e.href=d.href,document.head.removeChild(d),document.head.appendChild(e)}var f=document.getElementById(m.canvas);if(null!==f){if(f.classList.contains("m4n-canvas"))throw"Map already initialized for "+m.canvas;m.canvas=m.canvas+"-"+Math.random().toString(36).substring(7),f=z.createElement("canvas","m4n-canvas"),f.id=m.canvas}else f=z.createElement("canvas","m4n-canvas"),f.id=m.canvas;if("smart"==m.interact){var g=z.createElement("div","timeout-overlay",{click:function(){h()},touchstart:function(a){m.globals.dragPosition={x:a.touches[0].clientX,y:a.touches[0].clientY},m.globals.clickStart={x:a.touches[0].clientX,y:a.touches[0].clientY}},touchmove:function(a){m.globals.dragPosition={x:a.touches[0].clientX,y:a.touches[0].clientY}},touchend:function(){z.validateTouchMoveClickMargin(m.globals.clickStart,m.globals.dragPosition)&&h()}}),h=function(){g.style.display="none",z.setInteractTime()};g.style.display="block",m.timeoutOverlay=g,b.appendChild(g)}b.id=m.canvas+"-container",b.classList.add("m4n-container"),b.style.height="100%",b.style.width="100%",b.hasPredefinedHeight=0!==b.clientHeight;var i=document.createElement("div");i.id=m.canvas+"-popup-container",b.appendChild(i),b.appendChild(f),f.height=b.clientHeight,f.width=b.clientWidth}function i(){var a=z.createElement("div","m4n-zoom-container"),c=z.createElement("div","m4n-zoom-button",{click:function(){c.classList.contains("disabled")||m.api.zoom["in"]()}}),d=z.createElement("div","m4n-zoom-button",{click:function(){d.classList.contains("disabled")||m.api.zoom.out()}});j("level_changed",function(){var a=m.object.levels.getCurrent();d.classList.remove("disabled"),c.classList.remove("disabled"),a.level==m.object.levels.getHighest().level?d.classList.add("disabled"):a.level==m.object.levels.getLowest().level&&c.classList.add("disabled")}),a.style.zIndex=m.object.canvas.style.zIndex+1,a.appendChild(c),a.appendChild(d),b.appendChild(a)}function j(a,b){if("string"!=typeof a)throw"event must be a string; "+a+" given";if("function"!=typeof b)throw"callback must be a function";return m.dispatchEvents[a]||(m.dispatchEvents[a]=[]),m.dev&&console.log('Event listener for event "'+a+'" added',b),m.dispatchEvents[a].push(b)}function k(a,b){if("string"!=typeof a)throw"event must be a string; "+a+" given";if("number"!=typeof b)throw"id must be a number; "+b+" given";if(!m.dispatchEvents[a])throw"unknown event";if(!m.dispatchEvents[a][b-1])throw"unknown listener";m.dev&&console.log('Event listener for event "'+a+'" removed',m.dispatchEvents[a][b-1]),delete m.dispatchEvents[a][b-1]}function l(a,b){m.dispatchEvents[a]&&m.dispatchEvents[a].forEach(function(a){a(b)})}var m=this;!function(a){if(m.startTime=(new Date).getTime(),!a.path)throw"M4nInteractive Parameter 'path' is missing";if(!b)throw"M4nInteractive: No container was given";switch(m.interact=a.interact||"scroll",m.environment=a.environment||"online",m.version={map:"2.0",code:"2.0.4"},m.dev="development"==m.environment||a.debug&&"true"==a.debug,m.isMobile=/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),m.isIframe=window.location!==window.parent.location,m.canvas="m4n-"+Math.floor(65536*(1+Math.random())).toString(16).substring(1),m.url=m.json="",m.environment){case"development":m.url=location.href.split("/").slice(0,-1).join("/")+"/output/"+a.path+"/",m.json=m.url+"map.json";break;case"local":m.url=a.path.replace(/\/$/,"")+"/",m.json=m.url+"map.json";break;default:m.url="https://"+m.environment+".maps4news.com/output/"+a.path+"/",m.json="https://"+m.environment+".maps4news.com/ia/"+m.version.map+"/?id="+encodeURIComponent(a.path)}}(a);var n={youtube:{checkIfNeeded:function(){var a=!1;return m.object.popups.list.forEach(function(b){return"youtube"===b.media_type?(a=!0,n.youtube.download(),!1):void 0}),a},download:function(){if("undefined"==typeof YT){var a=document.createElement("script");a.src="//www.youtube.com/player_api";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}},enable:function(){null!==m.object&&"undefined"!=typeof YT&&m.object.popups.list.forEach(function(a){"youtube"===a.media_type&&(a.youtube=new YT.Player(a.html_id+"-youtube"))})}}};document.addEventListener("onYouTubeIframeAPIReady",n.youtube.enable,!1),window.onYouTubeIframeAPIReady=function(){document.dispatchEvent(new CustomEvent("onYouTubeIframeAPIReady",null))};var o=new XMLHttpRequest;o.open("GET",m.json,!0),o.onreadystatechange=function(){4==o.readyState&&200==o.status?d(o.responseText):200!==o.status&&console.error("Something went wrong!",o)},o.send(),m.dispatchEvents={},m.api={popup:function(a){var b=m.object.popups.get(a);if(null===b)throw"Popup "+a+" not found";return b.getApiObject()},popups:function(){return m.object.popups.getApiObject()},level:function(a){var b=m.object.levels.getLevel(a);return b.getApiObject()||null},levels:function(){return m.object.levels.getApiObject()},reset:function(){var a=m.object.levels.getIdealLevel();m.globals.offset.changeTo(-(a.size.width/2-m.object.canvas.width/2),-(a.size.height/2-m.object.canvas.height/2)),m.object.levels.change(a.level)},refit:function(){y.resize()},zoom:{to:function(a){a="number"==typeof a?a:0;var b={x:m.object.canvas.clientWidth/2,y:m.object.canvas.clientHeight/2},c=m.object.levels.getLevels([m.object.levels.current,a]);null!==c[1]&&(m.globals.offset.changeTo(b.x-c[1].size.width/c[0].size.width*(b.x-m.globals.offset.get().x),b.y-c[1].size.height/c[0].size.height*(b.y-m.globals.offset.get().y)),m.object.levels.change(c[1].level))},"in":function(){this.to(m.object.levels.current+1)},out:function(){this.to(m.object.levels.current-1)}},move:{left:function(a){var b=m.object.levels.getCurrent();m.globals.offset.changeBy(-40*(a||1),0),b.draw()},right:function(a){var b=m.object.levels.getCurrent();m.globals.offset.changeBy(40*(a||1),0),b.draw()},up:function(a){var b=m.object.levels.getCurrent();m.globals.offset.changeBy(0,-40*(a||1)),b.draw()},down:function(a){var b=m.object.levels.getCurrent();m.globals.offset.changeBy(0,40*(a||1)),b.draw()}}};var p=function(a){this._type="map",this.container=document.getElementById(m.canvas+"-container"),this.canvas=document.getElementById(m.canvas),this.context=this.canvas.getContext("2d"),f(this.context),this.popupContainer=document.getElementById(m.canvas+"-popup-container");for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])},q=function(a){if(this._type="level",this.is_loaded=!1,this.tiles={},a!==!1)for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])};q.prototype.getApiObject=function(){return{level:this.level,isLoaded:this.is_loaded,changeTo:function(){m.object.levels.change(this.level)}.bind(this),load:function(){this.load()}.bind(this)}},q.prototype.checkLoaded=function(){var a=0;this.tiles.list.forEach(function(b){b.state>1&&a++}),a===this.tiles.list.length&&(this.is_loaded=!0,l("level_loaded",this.getApiObject()))},q.prototype.draw=function(){m.object.popups.hideAll(),m.object.context.clearRect(0,0,m.object.canvas.width,m.object.canvas.height),m.globals.offset.changeTo(this.getBounds(!0,m.globals.offset.get().x),this.getBounds(!1,m.globals.offset.get().y)),this.tiles.draw(),m.object.levels.setCurrent(this.level),l("level_drawn",this.getApiObject())},q.prototype.load=function(){this.is_loaded||this.tiles.load()},q.prototype.isOn=function(a,b){return a>m.globals.offset.get().x&&a<this.size.width+m.globals.offset.get().x&&b>m.globals.offset.get().y&&b<this.size.height+m.globals.offset.get().y},q.prototype.getBounds=function(a,b){var c=a?m.object.canvas.clientWidth-this.size.width:m.object.canvas.clientHeight-this.size.height;return Math.max(Math.min(c,0),Math.min(Math.max(c,0),b))};var r=function(a){if(this._type="levels",this.current=0,a!==!1)for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])};r.prototype.getIdealLevel=function(){var a=this.getLevel(0);return this.getAllExcept(0).forEach(function(b){if(null!=a){var c,d;m.object.canvas.clientWidth>=m.object.canvas.clientHeight?(c=Math.abs(m.object.canvas.width-b.requested_area.size.width),d=Math.abs(m.object.canvas.width-a.requested_area.size.width)):(c=Math.abs(m.object.canvas.height-b.requested_area.size.height),d=Math.abs(m.object.canvas.height-a.requested_area.size.height)),d>c&&(a=b)}else a=b}),a},r.prototype.getApiObject=function(){var a=[];return this.list.forEach(function(b){a.push(b.getApiObject())}),{current:this.current,levels:a}},r.prototype.setCurrent=function(a){this.current!==a&&(this.current=a)},r.prototype.getLevel=function(a){for(var b=0;b<m.object.levels.list.length;b++)if(m.object.levels.list[b].level==a)return m.object.levels.list[b];return null},r.prototype.getLevels=function(a){for(var b=[],c=0;c<a.length;c++)b.push(this.getLevel(a[c]));return b},r.prototype.getAllExcept=function(a){"number"==typeof a&&(a=[a]);var b=[];return this.list.forEach(function(c){-1===a.indexOf(c.level)&&b.push(c)}),b},r.prototype.getCurrent=function(){return this.getLevel(this.current)},r.prototype.getHighest=function(){var a=this.getCurrent();return this.list.forEach(function(b){b.level<a.level&&(a=b)}),a},r.prototype.getLowest=function(){var a=this.getCurrent();return this.list.forEach(function(b){b.level>a.level&&(a=b)}),a},r.prototype.change=function(a){var b=this.getLevels([a,a+1,a-1]);if(null!==b[0]){var c=function(a){window.requestAnimationFrame(function(){a.draw(),l("level_changed",a.getApiObject())})};if(b[0].is_loaded)c(b[0]);else{b[0].load();var d=j("level_loaded",function(e){e.level==a&&(c(b[0]),k("level_loaded",d))})}null!==b[1]&&b[1].load(),null!==b[2]&&b[2].load()}},r.prototype.count=function(){return this.list.length};var s=function(a){if(this._type="point",a!==!1)for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);this.position={left:Math.min(this.shape[0].x,this.shape[1].x,this.shape[2].x,this.shape[3].x),top:Math.min(this.shape[0].y,this.shape[1].y,this.shape[2].y,this.shape[3].y)},this.size={width:Math.max(this.shape[0].x,this.shape[1].x,this.shape[2].x,this.shape[3].x)-this.position.left,height:Math.max(this.shape[0].y,this.shape[1].y,this.shape[2].y,this.shape[3].y)-this.position.top}};s.prototype.draw=function(){m.object.context.strokeRect(this.position.left+m.globals.offset.get().x,this.position.top+m.globals.offset.get().y,this.size.width,this.size.height)},s.prototype.isOn=function(a,b){return a>this.position.left+m.globals.offset.get().x&&a<this.position.left+this.size.width+m.globals.offset.get().x&&b>this.position.top+m.globals.offset.get().y&&b<this.position.top+this.size.height+m.globals.offset.get().y},s.prototype.location=function(){var a={left:this.position.left+m.globals.offset.get().x,top:this.position.top+m.globals.offset.get().y,right:-(this.position.left+m.globals.offset.get().x-m.object.canvas.clientWidth+this.size.width),bottom:-(this.position.top+m.globals.offset.get().y-m.object.canvas.clientHeight+this.size.height)};return a.location={x:function(){return a.left<5?"left":a.right<5?"right":"center"}(),y:function(){return a.top<5?"above":a.bottom<5?"beneath":"center"}()},a};var t=function(a){if(this._type="points",a!==!1)for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])};t.prototype.draw=function(){this.list.forEach(function(a){a.draw()})},t.prototype.hitAPoint=function(a,b){var c=null;return this.list.forEach(function(d){return d.isOn(a,b)?(c=d,!1):void 0}),c},t.prototype.get=function(a){for(var b=0;b<this.list.length;b++)if(this.list[b].number==a)return this.list[b];return null};var u=function(a){if(this._type="popup",this.on_screen=!1,a!==!1)for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);this.html_id=m.canvas+"-popup-"+this.number,this.video_id=m.html_id+"-video"};u.prototype.getApiObject=function(){return{number:this.number,title:this.title,info:this.info,show:function(a){this.show(a)}.bind(this),toggle:function(a,b){this.toggle(a,b)}.bind(this),hide:function(a){this.hide(a)}.bind(this)}},u.prototype.show=function(a){if(!this.on_screen){m.object.popups.hideAll(!0);var b=m.object.levels.getCurrent().points.get(this.number);if(a===!0)z.moveTo(b.position.left+b.size.width/2,b.position.top+b.size.height/2);else{var c={x:0,y:0},d=b.location();"center"===d.location.x&&"center"===d.location.y||(d.left<5?c.x=5-d.left:d.right<5&&(c.x=-(5-d.right)),d.top<5?c.y=5-d.top:d.bottom<5&&(c.y=-(5-d.bottom)),0===c.x&&0===c.y||z.moveBy(c.x,c.y))}var e=function(){return m.isMobile?this.onShowMobile(b):this.onShowDesktop(b)}.bind(this)();e&&(this.startVideo(),this.on_screen=!0,l("popup_shown",this.getApiObject()))}},u.prototype.onShowMobile=function(a){return!1},u.prototype.onShowDesktop=function(a){return!1},u.prototype.hide=function(a){this.on_screen&&this.onHide(a)&&(this.stopVideo(),this.on_screen=!1,l("popup_hidden",this.getApiObject()))},u.prototype.onHide=function(a){return!1},u.prototype.toggle=function(a,b){this.on_screen?this.hide(b):this.show(a)},u.prototype.stopVideo=function(){switch(this.media_type){case"youtube":this.youtube&&-1!==[YT.PlayerState.PLAYING,YT.PlayerState.BUFFERING].indexOf(this.youtube.getPlayerState())&&this.youtube.pauseVideo();break;case"video":document.getElementById(this.video_id).pause()}},u.prototype.startVideo=function(){try{switch(this.media_type){case"youtube":this.youtube&&-1!==[YT.PlayerState.UNSTARTED,YT.PlayerState.PAUSED,YT.PlayerState.CUED,YT.PlayerState.BUFFERING].indexOf(this.youtube.getPlayerState())&&this.youtube.playVideo();break;case"video":document.getElementById(this.video_id).play()}}catch(a){console.warn("YouTube wasn't ready, yet!",a)}},u.prototype.generateHTML=function(){var a="undefined"!=typeof this.title?this.title:"",b="undefined"!=typeof this.media?this.media:null,c="undefined"!=typeof this.info?this.info:null,d=document.createElement("div");d.id=this.html_id;var e=z.createElement("div","m4n-title");e.innerHTML=a;var f=z.createElement("div","m4n-info");f.innerHTML=c;var g=z.createElement("div","m4n-media");switch(this.media_type){case"":case"none":case null:case void 0:break;case"image":var h=document.createElement("img");h.alt=this.id,h.src=b,g.appendChild(h);break;case"youtube":var i=document.createElement("iframe");i.src="https://www.youtube.com/embed/"+this.media+"?modestbranding=1&autohide=1&controls=2&enablejsapi=1&showinfo=0",i.id=this.html_id+"-youtube",i.frameBorder=0,i.allowFullscreen=1,g.appendChild(i);break;case"video":var j=z.createElement("video","m4n-video");j.src=this.media,j.loop=!0,j.controls=!0,j.id=this.video_id,g.appendChild(j);break;default:throw this.media_type+" is an invalid media type"}switch(m.object.settings.placement){case"overlay":d=this.generateOverlay(d,e,f,g);break;case"sidebar":d=this.generateSidebar(d,e,f,g);break;default:d=this.generatePopover(d,e,f,g)}m.object.popupContainer.appendChild(d),this.onHide(!0)},u.prototype.generatePopover=function(a,b,c,d){a.classList.add("m4n-popover");var e=z.createElement("div","m4n-popover-triangle");return a.appendChild(e),a.appendChild(b),a.appendChild(d),a.appendChild(c),this.onHide=function(){a.style.display="none";var b=a.getElementsByClassName("m4n-popover-triangle")[0];return b.classList.remove("top","bottom","right","left"),b.style.left=null,b.style.top=null,!0},this.onShowMobile=function(){return a.style.display="block",a.style.left=m.object.canvas.clientWidth/2-a.clientWidth/2-m.object.canvas.getBoundingClientRect().left+"px",a.style.top=m.object.canvas.clientHeight/2-a.clientHeight/2-m.object.canvas.getBoundingClientRect().top+"px",!0},this.onShowDesktop=function(b){a.style.display="block";var c=16.97056274847714,d=Math.max(.15,Math.min(.85,(b.position.left+m.globals.offset.get().x)/m.object.canvas.clientWidth)),e=Math.max(.05,Math.min(.85,(b.position.top+m.globals.offset.get().y)/m.object.canvas.clientHeight)),f=a.getElementsByClassName("m4n-popover-triangle")[0],g={nextTo:m.globals.offset.get().x+b.position.left+a.clientWidth*d+b.size.width/2<m.object.canvas.clientWidth&&m.globals.offset.get().x+b.position.left-a.clientWidth*d+b.size.width/2>0,above:m.globals.offset.get().y+b.position.top-c>a.clientHeight,beneath:m.object.canvas.clientHeight-(m.globals.offset.get().y+b.position.top+b.size.height+c)>a.clientHeight,left:m.globals.offset.get().x+b.position.left-c>a.clientWidth,right:m.object.canvas.clientWidth-(m.globals.offset.get().x+b.position.left+b.size.width+c)>a.clientWidth},h=function(){f.classList.add("bottom"),a.style.top=m.globals.offset.get().y+b.position.top-a.clientHeight-c+"px",a.style.left=m.globals.offset.get().x+b.position.left+b.size.width/2-a.clientWidth*d+"px",f.style.left=100*d+"%"},i=function(){f.classList.add("top"),a.style.top=m.globals.offset.get().y+b.position.top+b.size.height+c+"px",a.style.left=m.globals.offset.get().x+b.position.left+b.size.width/2-a.clientWidth*d+"px",f.style.left=100*d+"%"},j=function(){f.classList.add("right"),a.style.top=m.globals.offset.get().y+b.position.top+b.size.height/2-a.clientHeight*e-10+"px",a.style.left=m.globals.offset.get().x+b.position.left-a.clientWidth-c+"px",f.style.top=100*e+"%"},k=function(){f.classList.add("left"),a.style.top=m.globals.offset.get().y+b.position.top+b.size.height/2-a.clientHeight*e-10+"px",a.style.left=m.globals.offset.get().x+b.position.left+b.size.width+c+"px",f.style.top=100*e+"%"};return!g.above&&g.beneath||!g.nextTo?g.nextTo?i():g.left?j():g.right?k():h():h(),!0},a},u.prototype.generateOverlay=function(a,b,c,d){a.classList.add("m4n-overlay");var e=document.createElement("div");e.appendChild(b),e.appendChild(d),e.appendChild(c);var f=document.createElement("div"),g=document.createElement("div"),h=z.createElement("span","close_overlay",{click:function(){this.hide()}.bind(this),touchend:function(){this.hide()}.bind(this)});return g.appendChild(e),f.appendChild(g),a.appendChild(f),a.appendChild(h),this.onHide=function(){return a.style.display="none",!0},this.onShowDesktop=this.onShowMobile=function(){return a.style.display="block",a.style.left=m.object.canvas.clientLeft+"px",a.style.top=m.object.canvas.clientTop+"px",a.style.width=m.object.canvas.clientWidth+"px",a.style.height=m.object.canvas.clientHeight+"px",!0},a},u.prototype.generateSidebar=function(a,b,c,d){a.classList.add("m4n-sidebar-container");var e=z.createElement("div","m4n-sidebar"),f=z.createElement("div","m4n-sidebar-header"),g=z.createElement("div","m4n-sidebar-close",{click:function(){this.hide(!0)}.bind(this),touchend:function(){this.hide(!0)}.bind(this)});f.appendChild(g),f.appendChild(b);var h=z.createElement("div","m4n-sidebar-content");h.appendChild(d),h.appendChild(c);var i=z.createElement("div","m4n-sidebar-footer"),j=z.createElement("ul","m4n-pagination"),k=z.createElement("li",null,{click:function(){this.hide(!0);var a;a=this.number!=m.object.popups.getFirst().number?m.api.popup(self.number-1):m.api.popup(m.object.popups.getLast().number),null!==a&&a.show(!0)}.bind(this)}),l=z.createElement("li",null,{click:function(){this.hide(!0);var a;a=this.number!=m.object.popups.getLast().number?m.api.popup(self.number+1):m.api.popup(m.object.popups.getFirst().number),null!==a&&a.show(!0)}.bind(this)}),n=document.createElement("div");return n.style.clear="both",j.appendChild(k),j.appendChild(l),i.appendChild(j),i.appendChild(n),e.appendChild(f),e.appendChild(h),e.appendChild(i),a.appendChild(e),this.onHide=function(b){return b===!0?(a.style.display="none",!0):!1},this.onShowDesktop=this.onShowMobile=function(){return a.style.removeProperty("display"),!0},a};var v=function(a){if(this._type="popups",a!==!1)for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])};v.prototype.getApiObject=function(){var a=[];return this.list.forEach(function(b){a.push(b.getApiObject())}),a},v.prototype.get=function(a){for(var b=0;b<this.list.length;b++)if(this.list[b].number==a)return this.list[b];return null},v.prototype.getAll=function(){return this.list},v.prototype.getFirst=function(){return this.list[0]},v.prototype.getLast=function(){return this.list[this.list.length-1]},v.prototype.generateHTML=function(){this.list.forEach(function(a){a.generateHTML()})},v.prototype.hideAll=function(a){this.list.forEach(function(b){b.hide(a)})},v.prototype.getCurrent=function(){var a=null;return this.getAll().forEach(function(b){return b.on_screen?(a=b,!1):void 0}),a};var w=function(a){if(this._type="tile",this.image=new Image,this.state=0,this.loadingStates={initial:0,loading:1,loaded:2,error:3},a!==!1)for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])};w.prototype.load=function(){this.image.src=m.url+this.url,this.state=1,this.image.onload=function(){this.state=2,m.object.levels.getLevel(this.level).checkLoaded()}.bind(this),this.image.onerror=function(){this.state=3,m.object.levels.getLevel(this.level).checkLoaded()}.bind(this)},w.prototype.draw=function(){var a=function(){var a=this.position.left+m.globals.offset.get().x,b=this.position.top+m.globals.offset.get().y;this.isVisible(a,b,this.size.width,this.size.height)&&m.object.context.drawImage(this.image,a,b,this.size.width,this.size.height)}.bind(this),b=function(){var a=m.globals.offset.get();m.object.context.lineWidth=8,m.object.context.lineCap="round",m.object.context.beginPath(),m.object.context.moveTo(10+this.position.left+a.x,10+this.position.top+a.y),m.object.context.lineTo(-10+this.position.left+this.size.width+a.x,-10+this.position.top+this.size.height+a.y),m.object.context.stroke(),m.object.context.beginPath(),m.object.context.moveTo(10+this.position.left+a.x,-10+this.position.top+this.size.height+a.y),m.object.context.lineTo(-10+this.position.left+this.size.width+a.x,10+this.position.top+a.y),m.object.context.stroke(),this.state=3}.bind(this);switch(this.state){case this.loadingStates.initial:this.load();break;case this.loadingStates.loading:break;case this.loadingStates.loaded:a();break;case this.loadingStates.error:b()}},w.prototype.isVisible=function(a,b,c,d){return a<m.object.canvas.width&&a+c>0&&b<m.object.canvas.height&&b+d>0};var x=function(a){if(this._type="tiles",a!==!1)for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])};x.prototype.draw=function(){this.list.forEach(function(a){a.draw()})},x.prototype.load=function(){this.list.forEach(function(a){a.state===a.loadingStates.initial&&a.load()})},x.prototype.count=function(){return this.list.length},x.prototype.getAll=function(){return this.list},x.prototype.get=function(a){return this.list[a]};var y={mouseDown:function(a){a.preventDefault(),m.object.levels.getCurrent().isOn(a.layerX,a.layerY)&&(z.doubleTap(),m.globals.clickStart={x:a.pageX,y:a.pageY},m.globals.dragPosition={x:a.pageX,y:a.pageY},1===a.which&&(m.globals.isDown=!0))},touchStart:function(a){a.preventDefault(),m.object.levels.getCurrent().isOn(a.touches[0].clientX,a.touches[0].clientY)&&(z.doubleTap(),m.globals.isDown=!0,m.globals.dragPosition={x:a.touches[0].clientX,y:a.touches[0].clientY},m.globals.clickStart={x:a.touches[0].clientX,y:a.touches[0].clientY}),2==a.touches.length&&(m.globals.isScaling=!0,m.globals.startDistance=Math.sqrt((a.touches[0].pageX-a.touches[1].pageX)*(a.touches[0].pageX-a.touches[1].pageX)+(a.touches[0].pageY-a.touches[1].pageY)*(a.touches[0].pageY-a.touches[1].pageY))),1==a.touches.length&&m.globals.doubleTap===!0&&(m.globals.isScaling=!0,m.globals.startDistance=1,m.globals.lastPos={x:(m.globals.clickStart.x+a.touches[0].pageX)/2,y:(m.globals.clickStart.y+a.touches[0].pageY)/2})},mouseUp:function(a){if(a.preventDefault(),a.target.id==m.canvas&&(z.setInteractTime(),m.globals.isDown=!1,a.pageX==m.globals.clickStart.x&&a.pageY==m.globals.clickStart.y)){var b=m.object.levels.getCurrent().points.hitAPoint(a.layerX,a.layerY);null!==b&&1===a.which?(m.object.canvas.style.cursor="pointer",m.object.popups.get(b.number).show()):m.globals.doubleTap===!0?(y.dblclick(a),m.globals.doubleTap=null):(m.object.canvas.style.cursor="auto",m.object.popups.hideAll())}},touchEnd:function(a){if(a.preventDefault(),m.globals.isDown=!1,a.target.id==m.canvas)if(z.setInteractTime(),z.validateTouchMoveClickMargin(m.globals.clickStart,m.globals.dragPosition)&&!m.globals.isScaling){var b=m.object.levels.getCurrent().points.hitAPoint(m.globals.dragPosition.x,m.globals.dragPosition.y);null!==b?m.object.popups.get(b.number).show():m.globals.doubleTap===!0?(y.dbltap(a),m.globals.doubleTap=null):m.object.popups.hideAll()}else m.globals.doubleTap===!0&&(m.globals.doubleTap=null);if(m.globals.isScaling){for(var c=m.globals.new_distance-m.globals.startDistance,d=Math.round(Math.abs(c)/100),e=m.object.levels.getCurrent(),f=m.object.levels.getLevel(e.level+function(){return c>0?d:-d}());null===f;)d--,f=m.object.levels.getLevel(f);if(d>0){var g=[e,f],h={x:m.globals.lastPos.x,y:m.globals.lastPos.y};m.globals.offset.changeTo(h.x-g[1].size.width/g[0].size.width*(h.x-m.globals.offset.get().x),h.y-g[1].size.height/g[0].size.height*(h.y-m.globals.offset.get().y)),m.object.levels.change(f.level),m.globals.startDistance=0,m.globals.isScaling=!1}m.object.context.setTransform(1,0,0,1,0,0),m.object.levels.getCurrent().draw()}},mouseMove:function(a){var b=m.object.levels.getCurrent();if(m.globals.isDown&&z.isInteracting())z.setInteractTime(),a.preventDefault(),m.object.canvas.style.cursor="all-scroll",m.globals.offset.changeBy(a.pageX-m.globals.dragPosition.x,a.pageY-m.globals.dragPosition.y),m.globals.dragPosition={x:a.pageX,y:a.pageY},b.draw();else if(a.target.id==m.canvas){var c=b.points.hitAPoint(a.layerX,a.layerY);m.object.canvas.style.cursor=null!==c?"pointer":"auto","mouseenter"==m.object.settings.eventType&&(null!==c?m.object.popups.get(c.number).show():m.object.popups.hideAll())}},touchMove:function(a){if(m.globals.isDown&&z.isInteracting()){a.preventDefault(),z.setInteractTime();var b=a.touches,c=m.object.levels.getCurrent();if(1===b.length){var d=b[0],e={x:m.globals.offset.get().x+d.clientX-m.globals.dragPosition.x,y:m.globals.offset.get().y+d.clientY-m.globals.dragPosition.y};if(e.x!==m.globals.offset.get().x&&e.y!==m.globals.offset.get().y){if(m.globals.doubleTap===!0&&m.globals.isScaling){m.globals.new_distance=Math.sqrt((m.globals.clickStart.x-b[0].pageX)*(m.globals.clickStart.x-b[0].pageX)+(m.globals.clickStart.y-b[0].pageY)*(m.globals.clickStart.y-b[0].pageY));var f=z.gesturePinchZoom(a)/40;1>f&&f>-1&&(m.globals.distance=f,z.zoom(f))}else m.globals.offset.changeTo(e.x,e.y),c.draw();m.globals.dragPosition={x:d.clientX,y:d.clientY}}}else if(2===b.length&&m.globals.isScaling===!0){m.globals.new_distance=Math.sqrt((b[0].pageX-b[1].pageX)*(b[0].pageX-b[1].pageX)+(b[0].pageY-b[1].pageY)*(b[0].pageY-b[1].pageY)),m.globals.lastPos={x:(b[0].pageX+b[1].pageX)/2,y:(b[0].pageY+b[1].pageY)/2};var f=z.gesturePinchZoom(a)/40;1>f&&f>-1&&(m.globals.distance=f,z.zoom(f))}}},mouseWheel:function(a){var b=function(){switch(m.interact){case"scroll":return!a.ctrlKey;case"smart":return z.isInteracting();default:return a.ctrlKey}}();if(a.target.id==m.canvas&&b){z.setInteractTime(),clearTimeout(m.globals.scroll.timeout),a.preventDefault(),m.globals.scroll.value+=function(){var b=a.wheelDelta,c=a.detail;return c?b?b/c/40*c>0?1:-1:-c/3:b/120}();var c=m.globals.scroll.value>1?1:m.globals.scroll.value<-1?-1:0;if(0!==c){m.globals.scroll.value=0;var d=m.object.levels.getLevels([m.object.levels.current,m.object.levels.current+c]);null!==d[1]&&(m.globals.offset.changeTo(a.layerX-d[1].size.width/d[0].size.width*(a.layerX-m.globals.offset.get().x),a.layerY-d[1].size.height/d[0].size.height*(a.layerY-m.globals.offset.get().y)),m.object.levels.change(d[0].level+c))}}},dblclick:function(a){if(a.target.id==m.canvas&&m.object.levels.getCurrent().isOn(a.layerX,a.layerY)&&z.isInteracting()){z.setInteractTime();var b=m.object.levels.getCurrent(),c=m.object.levels.getLevel(b.level+function(){return 1==a.which?1:-1}());null!==c&&(m.globals.offset.changeTo(a.layerX-c.size.width/b.size.width*(a.layerX-m.globals.offset.get().x),a.layerY-c.size.height/b.size.height*(a.layerY-m.globals.offset.get().y)),m.object.levels.change(c.level))}},dbltap:function(a){if(a.target.id==m.canvas&&m.object.levels.isOn(m.globals.dragPosition.x,m.globals.dragPosition.y)){z.setInteractTime();var b=m.object.levels.getLevels([m.object.levels.current,m.object.levels.current+1]);null!==b[1]&&(m.globals.offset.changeTo(m.globals.dragPosition.x-b[1].size.width/b[0].size.width*(m.globals.dragPosition.x-m.globals.offset.get().x),m.globals.dragPosition.y-b[1].size.height/b[0].size.height*(m.globals.dragPosition.y-m.globals.offset.get().y)),m.object.levels.change(m.object.levels.current+1))}},contextMenu:function(a){a.preventDefault()},resize:function(){var a=document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullScreenElement;if(a&&[a.id.indexOf("-youtube"),a.id.indexOf("-video")].indexOf(-1)>-1&&(m.globals.videoFullscreen.value=!0,m.globals.videoFullscreen.noEvents=0),!m.globals.videoFullscreen.value&&((new Date).getTime()-m.globals.videoFullscreen.date>3e3||m.globals.videoFullscreen.noEvents>1)){var b=m.object.levels.getCurrent(),c={w:m.object.canvas.width,h:m.object.canvas.height};m.object.canvas.height=m.object.container.clientHeight,m.object.canvas.width=m.object.container.clientWidth,m.globals.offset.changeBy(-((c.w-m.object.canvas.width)/2),-((c.h-m.object.canvas.height)/2)),b.draw()}a||(m.globals.videoFullscreen={
value:!1,date:(new Date).getTime(),noEvents:m.globals.videoFullscreen.noEvents+1})}};m.globals={isDown:!1,isScaling:!1,clickStart:{x:0,y:0},dragPosition:{x:0,y:0},mapOffset:{x:0,y:0},doubleTap:null,videoFullscreen:{value:!1,date:null,noEvents:2},scroll:{value:0,timeout:null},startDistance:0,scaleFactor:1.1,lastPos:{x:0,y:0},interact:{isInteracting:!1,timer:null},offset:{changeBy:function(a,b){m.globals.mapOffset.x+=a,m.globals.mapOffset.y+=b},changeTo:function(a,b){m.globals.mapOffset={x:a,y:b}},get:function(){return m.globals.mapOffset}}};var z={moveTo:function(a,b){m.globals.offset.changeTo(-(a-m.object.canvas.clientWidth/2),-(b-m.object.canvas.clientHeight/2)),m.object.levels.getCurrent().draw()},moveBy:function(a,b){m.globals.offset.changeBy(a,b),m.object.levels.getCurrent().draw()},doubleTap:function(){m.globals.doubleTap=null!==m.globals.doubleTap&&(new Date).getTime()-m.globals.doubleTap<=250?!0:(new Date).getTime()},gesturePinchZoom:function(a){var b=!1;if(a.targetTouches.length>=2){var c=a.targetTouches[0],d=a.targetTouches[1],e=Math.sqrt(Math.pow(d.pageX-c.pageX,2)+Math.pow(d.pageY-c.pageY,2));this.lastZoomScale&&(b=e-this.lastZoomScale),this.lastZoomScale=e}return b},zoom:function(a){var b=m.object.context.transformedPoint(m.globals.lastPos.x,m.globals.lastPos.y);m.object.context.translate(b.x,b.y);var c=Math.pow(m.globals.scaleFactor,a);m.object.context.scale(c,c),m.object.context.translate(-b.x,-b.y),m.object.levels.getCurrent().draw()},createElement:function(a,b,c){var d=document.createElement(a);null!==b&&d.classList.add(b);for(var e in c)c.hasOwnProperty(e)&&d.addEventListener(e,c[e]);return d},setInteractTime:function(a){if("smart"===m.interact){var b=function(){if(m.globals.isDown)m.dev&&console.log("Finger or mouse is down");else{var b=m.object.popups.getCurrent();if(null===b)m.globals.interact.isInteracting=!1,z.showTimeoutOverlay(),void 0!==a&&k("popup_hidden",a);else var c=j("popup_hidden",function(){z.setInteractTime(c),k("popup_hidden",c)})}};clearTimeout(m.globals.interact.timer),m.globals.interact={isInteracting:!0,timer:setTimeout(b,3e3)}}},isInteracting:function(){return"smart"!=m.interact||m.globals.interact.isInteracting},showTimeoutOverlay:function(){m.timeoutOverlay.style.display="block"},validateTouchMoveClickMargin:function(a,b){return a.x>b.x-2&&a.x<b.x+2&&a.y>b.y-2&&a.y<b.y+2}},A={};return Object.defineProperties(A,{api:{value:m.api,writable:!1},addEventListener:{value:j,writable:!1},removeEventListener:{value:k,writable:!1}}),m.dev&&(A.object=function(){return m}),A};